(function(){"use strict";var e={5766:function(e,r,a){var n=a(5130),t=a(6768);const s={id:"app"};function i(e,r,a,n,i,o){const c=(0,t.g2)("CameraScanner");return(0,t.uX)(),(0,t.CE)("div",s,[(0,t.bF)(c)])}var o=a(4232);const c={id:"app"},d={class:"toggle-mode"},l=["disabled"],u=["disabled"],m={id:"scanner",ref:"scannerContainer"},h={id:"scanner",ref:"scannerContainer"},g={id:"output"},p={key:2,class:"error-message"},f=["disabled"],S=["disabled"],C={id:"log"},v={id:"test-camera-section"},L={ref:"testCameraVideo",autoplay:"",muted:"",playsinline:"",style:{width:"100%","max-width":"600px",height:"auto",border:"1px solid #ccc"}},b=["disabled"],k=["disabled"];function T(e,r,a,s,i,T){return(0,t.uX)(),(0,t.CE)("div",c,[r[15]||(r[15]=(0,t.Lk)("header",null,[(0,t.Lk)("img",{src:"https://cdn.prod.website-files.com/65363d385688281ce5b016ec/65363d385688281ce5b016f5_Vectors-Wrapper.svg",alt:"Celfocus Logo"})],-1)),r[16]||(r[16]=(0,t.Lk)("h1",null,"Camera Test",-1)),(0,t.Lk)("div",d,[(0,t.Lk)("label",null,[(0,t.bo)((0,t.Lk)("input",{type:"radio","onUpdate:modelValue":r[0]||(r[0]=e=>i.cameraMode=e),value:"inline",disabled:i.isScannerRunning},null,8,l),[[n.XL,i.cameraMode]]),r[9]||(r[9]=(0,t.eW)(" Inline "))]),(0,t.Lk)("label",null,[(0,t.bo)((0,t.Lk)("input",{type:"radio","onUpdate:modelValue":r[1]||(r[1]=e=>i.cameraMode=e),value:"modal",disabled:i.isScannerRunning},null,8,u),[[n.XL,i.cameraMode]]),r[10]||(r[10]=(0,t.eW)(" Modal "))])]),"inline"===i.cameraMode?((0,t.uX)(),(0,t.CE)("div",{id:"camera-container",onClick:r[2]||(r[2]=(...e)=>T.toggleScanner&&T.toggleScanner(...e)),key:i.scannerKey},[(0,t.Lk)("div",m,null,512)])):(0,t.Q3)("",!0),"modal"===i.cameraMode&&i.showModal?((0,t.uX)(),(0,t.CE)("div",{key:1,class:"modal-overlay",onClick:r[4]||(r[4]=(0,n.D$)(((...e)=>T.stopScanner&&T.stopScanner(...e)),["self"]))},[((0,t.uX)(),(0,t.CE)("div",{class:"modal-content",key:i.scannerKey},[(0,t.Lk)("div",h,null,512),(0,t.Lk)("button",{class:"close-btn",onClick:r[3]||(r[3]=(...e)=>T.stopScanner&&T.stopScanner(...e))},"Close")]))])):(0,t.Q3)("",!0),(0,t.Lk)("div",g,[r[11]||(r[11]=(0,t.eW)(" Scanned Result: ")),(0,t.Lk)("span",null,(0,o.v_)(i.scannedResult),1)]),i.errorMessage?((0,t.uX)(),(0,t.CE)("div",p,(0,o.v_)(i.errorMessage),1)):(0,t.Q3)("",!0),(0,t.Lk)("button",{onClick:r[5]||(r[5]=(...e)=>T.startScanner&&T.startScanner(...e)),disabled:i.isScannerRunning}," Start Scanner ",8,f),(0,t.Lk)("button",{onClick:r[6]||(r[6]=(...e)=>T.stopScanner&&T.stopScanner(...e)),disabled:!i.isScannerRunning}," Stop Scanner ",8,S),(0,t.Lk)("div",C,[r[12]||(r[12]=(0,t.Lk)("h2",null,"Application Log",-1)),(0,t.Lk)("ul",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.logs,((e,r)=>((0,t.uX)(),(0,t.CE)("li",{key:r},(0,o.v_)(e),1)))),128))])]),(0,t.Lk)("div",v,[r[13]||(r[13]=(0,t.Lk)("h2",null,"Test Camera Section",-1)),(0,t.Lk)("video",L,null,512),r[14]||(r[14]=(0,t.Lk)("br",null,null,-1)),(0,t.Lk)("button",{onClick:r[7]||(r[7]=(...e)=>T.startTestCamera&&T.startTestCamera(...e)),disabled:i.testCameraRunning}," Start Test Camera ",8,b),(0,t.Lk)("button",{onClick:r[8]||(r[8]=(...e)=>T.stopTestCamera&&T.stopTestCamera(...e)),disabled:!i.testCameraRunning}," Stop Test Camera ",8,k)])])}a(4114),a(8111),a(7588);var y=a(1613),M=a.n(y),w={name:"CameraScanner",data(){return{isScannerRunning:!1,scannedResult:"None",cameraStream:null,errorMessage:"",errorTimer:null,cameraMode:"inline",showModal:!1,scannerKey:0,logs:[],testCameraRunning:!1,testCameraStream:null}},watch:{cameraMode(){this.addLog(`Camera mode changed to: ${this.cameraMode}`),this.scannerKey++}},methods:{addLog(e){const r=(new Date).toLocaleTimeString();this.logs.push(`${r}: ${e}`)},logCameraPermissionStatus(){navigator.permissions?navigator.permissions.query({name:"camera"}).then((e=>{this.addLog("Camera permission status: "+e.state)})).catch((e=>{this.addLog("Camera permission query failed: "+e)})):this.addLog("Permissions API not supported.")},showError(e){this.errorTimer&&clearTimeout(this.errorTimer),this.errorMessage=e,this.addLog(`Error: ${e}`),this.errorTimer=setTimeout((()=>{this.errorMessage="",this.errorTimer=null}),5e3)},initScanner(){this.errorTimer&&(clearTimeout(this.errorTimer),this.errorTimer=null),this.errorMessage="",this.addLog("Initializing scanner..."),M().init({inputStream:{type:"LiveStream",target:this.$refs.scannerContainer,constraints:{facingMode:"environment"}},decoder:{readers:["code_128_reader","ean_reader","ean_8_reader","code_39_reader"]}},(e=>{if(e)return this.addLog(`QuaggaJS Initialization Error: ${e.name} - ${e.message}`),console.error("QuaggaJS Initialization Error:",e),"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?this.showError("Camera access was denied. Please allow camera permissions."):"NotReadableError"===e.name||"TrackStartError"===e.name?this.showError("The camera is currently in use by another application. Please close it and try again."):this.showError("Unable to access the camera. Please try again later."),void("modal"===this.cameraMode&&(this.showModal=!1));this.addLog("Initializing scanner Complete... Calling startScannerAfterInit"),this.startScannerAfterInit()})),M().onDetected((e=>{this.scannedResult=e.codeResult.code,this.addLog(`Detected code: ${e.codeResult.code}`)}))},startScannerAfterInit(){this.addLog("Calling Quagga.start()..."),M().start(),this.isScannerRunning=!0,this.addLog("Scanner started successfully."),this.cameraStream=this.$refs.scannerContainer.querySelector("video")?this.$refs.scannerContainer.querySelector("video").srcObject:null,this.logCameraPermissionStatus()},startScanner(){this.isScannerRunning||(this.addLog("Attempting to start scanner..."),this.scannerKey++,this.$nextTick((()=>{"modal"===this.cameraMode?(this.showModal=!0,this.addLog("Showing modal..."),this.$nextTick((()=>{this.initScanner()}))):this.initScanner()})))},stopScanner(){if(this.isScannerRunning){if(this.addLog("Stopping scanner..."),M().stop(),this.$refs.scannerContainer){const e=this.$refs.scannerContainer.querySelector("video");e&&(e.pause(),e.srcObject=null,this.addLog("Video element paused and srcObject cleared."))}this.scannerKey++,"inline"===this.cameraMode&&this.$refs.scannerContainer&&(this.$refs.scannerContainer.innerHTML="",this.addLog("Scanner container innerHTML cleared.")),this.cameraStream&&(this.cameraStream.getTracks().forEach(((e,r)=>{e.stop(),this.addLog(`Track ${r} (${e.kind}) stopped.`)})),this.cameraStream=null),M().offDetected(),this.isScannerRunning=!1,this.addLog("Scanner stopped and all references cleared."),this.errorTimer&&(clearTimeout(this.errorTimer),this.errorTimer=null),this.errorMessage="","modal"===this.cameraMode&&(this.showModal=!1),this.logCameraPermissionStatus()}else"modal"===this.cameraMode&&this.showModal&&(this.showModal=!1)},toggleScanner(){"inline"===this.cameraMode&&(this.isScannerRunning?this.stopScanner():this.startScanner())},startTestCamera(){this.testCameraRunning||navigator.mediaDevices.getUserMedia({video:!0}).then((e=>{this.$refs.testCameraVideo.srcObject=e,this.testCameraStream=e,this.testCameraRunning=!0,this.addLog("Test camera started."),this.logCameraPermissionStatus()})).catch((e=>{this.addLog(`Error starting test camera: ${e}`),this.showError(`Error starting test camera: ${e.message}`)}))},stopTestCamera(){this.testCameraRunning&&(this.testCameraStream&&this.testCameraStream.getTracks().forEach(((e,r)=>{e.stop(),this.addLog(`Test camera track ${r} (${e.kind}) stopped.`)})),this.$refs.testCameraVideo&&(this.$refs.testCameraVideo.srcObject=null),this.testCameraRunning=!1,this.testCameraStream=null,this.addLog("Test camera stopped."),this.logCameraPermissionStatus())}},beforeUnmount(){this.isScannerRunning&&this.stopScanner(),this.testCameraRunning&&this.stopTestCamera(),this.errorTimer&&(clearTimeout(this.errorTimer),this.errorTimer=null)}},E=a(1241);const R=(0,E.A)(w,[["render",T],["__scopeId","data-v-52916282"]]);var $=R,_={name:"App",components:{CameraScanner:$}};const O=(0,E.A)(_,[["render",i]]);var P=O;(0,n.Ef)(P).mount("#app")}},r={};function a(n){var t=r[n];if(void 0!==t)return t.exports;var s=r[n]={exports:{}};return e[n].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(r,n,t,s){if(!n){var i=1/0;for(l=0;l<e.length;l++){n=e[l][0],t=e[l][1],s=e[l][2];for(var o=!0,c=0;c<n.length;c++)(!1&s||i>=s)&&Object.keys(a.O).every((function(e){return a.O[e](n[c])}))?n.splice(c--,1):(o=!1,s<i&&(i=s));if(o){e.splice(l--,1);var d=t();void 0!==d&&(r=d)}}return r}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[n,t,s]}}(),function(){a.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(r,{a:r}),r}}(),function(){a.d=function(e,r){for(var n in r)a.o(r,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)}}(),function(){var e={524:0};a.O.j=function(r){return 0===e[r]};var r=function(r,n){var t,s,i=n[0],o=n[1],c=n[2],d=0;if(i.some((function(r){return 0!==e[r]}))){for(t in o)a.o(o,t)&&(a.m[t]=o[t]);if(c)var l=c(a)}for(r&&r(n);d<i.length;d++)s=i[d],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(l)},n=self["webpackChunkmy_scanner_app"]=self["webpackChunkmy_scanner_app"]||[];n.forEach(r.bind(null,0)),n.push=r.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(5766)}));n=a.O(n)})();
//# sourceMappingURL=app.6be75ae0.js.map